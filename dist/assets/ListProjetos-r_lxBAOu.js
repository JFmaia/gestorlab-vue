import{d as ye,s as ke,r as d,z as je,o as n,h as L,K as f,g as e,c,x as i,Q as le,a3 as G,a as t,q as we,w as x,v as se,m as _e,i as q,t as m,N as fe,k as X,F as B,j as Ce,a5 as Se,a4 as Pe,p as be,e as xe,f as De,J as U,D as ae,E as ve,a6 as me,W,P as Ve,S as ge,R as Ee,T as Me}from"./index-DQb3qgME.js";import{p as $e,M as Qe}from"./MyCard-D9OjYwNM.js";import{p as Ue}from"./perm-B5m12WYu.js";import{M as qe}from"./ModalCreateProject-BmODDPMi.js";import{u as Be,c as Le,a as he}from"./vee-validate.esm-Bvbop3-v.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./laboratory-CLtynE2K.js";const ie=w=>(be("data-v-97be169d"),w=w(),xe(),w),Te={key:0,class:"info"},Ne=ie(()=>t("h3",null," Edite os dados ",-1)),ze=["src"],Ae={class:"content"},Fe=ie(()=>t("label",null,"Título:",-1)),Re={class:"content"},We=ie(()=>t("label",null,"Descrição:",-1)),He=ye({__name:"ModelEditProjeto",props:{tipo:{type:Number,required:!0},proj:{type:Object,required:!1,default:null}},emits:["event"],setup(w,{emit:T}){const N=T,$=w,Y=$e(),I=ke();let l=d(!1),g=d(!1),P=d(null),k=d(null),z=d(null);const{errors:S,validate:M,defineField:A}=Be({validationSchema:Le({titulo:he().required("Por favor digite seu primeiro nome!"),descricao:he().required("Por favor digite seu segundo nome!")})}),[b,H]=A("titulo"),[h,Q]=A("descricao");je(async()=>{await Z()});async function Z(){if(l.value=!0,$.tipo===2)b.value=$.proj.titulo,h.value=$.proj.descricao;else return;l.value=!1}async function ee(){if((await M()).valid){g.value=!0;const p={titulo:b.value,image:k.value,descricao:h.value},_=await Y.editProjeto(p,$.proj.id,I.getToken);_===!0?(N("event",!1),g.value=!1):(g.value=!1,alert(_))}}function te(F){var J;const _=(J=F.target.files)==null?void 0:J[0];if(!_)return;P.value=_;const V=new FileReader;V.onload=async oe=>{var R;const s=new Image;s.src=(R=oe.target)==null?void 0:R.result,await new Promise(O=>{s.onload=()=>O()});const a=800,u=600,C=.7,v=document.createElement("canvas"),j=v.getContext("2d");let r=s.width,y=s.height;r>a&&(y=y*a/r,r=a),y>u&&(r=r*u/y,y=u),v.width=r,v.height=y,j==null||j.drawImage(s,0,0,r,y);const K=v.toDataURL("image/jpeg",C);k.value=K},V.readAsDataURL(_)}return(F,p)=>(n(),L(e(Pe),{class:"card-create-dialog"},{default:f(()=>[e(l)?(n(),c("div",Te,[i(e(le),{size:"20px",color:"primary"})])):(n(),c(B,{key:1},[i(e(G),null,{default:f(()=>[Ne]),_:1}),i(e(G),{class:"section-body"},{default:f(()=>[t("button",{onClick:p[0]||(p[0]=_=>{var V;return(V=e(z))==null?void 0:V.click()}),class:"button-img"},[e(k)===null?(n(),L(e(we),{key:0,name:"add_a_photo",size:"4rem",color:"white",alt:"Imagem para escolher"})):(n(),c("img",{key:1,src:e(k),alt:"Imagem que foi escolhida"},null,8,ze)),t("input",{ref_key:"fileInput",ref:z,type:"file",style:{display:"none"},onChange:te},null,544)]),t("div",Ae,[Fe,x(t("input",_e({"onUpdate:modelValue":p[1]||(p[1]=_=>q(b)?b.value=_:null)},e(H),{type:"text",placeholder:"Digite o titulo do seu projeto"}),null,16),[[se,e(b)]]),t("pre",null,m(e(S).titulo),1)]),t("div",Re,[We,x(t("textarea",_e({"onUpdate:modelValue":p[2]||(p[2]=_=>q(h)?h.value=_:null)},e(Q),{minlength:"3",type:"text",placeholder:"Digite aqui o seu segundo nome"}),null,16),[[se,e(h)]]),t("pre",null,m(e(S).descricao),1)])]),_:1}),i(e(Se),{align:"right",class:"text-primary"},{default:f(()=>[i(e(fe),{flat:"",label:"Cancelar",onClick:p[3]||(p[3]=X(_=>N("event",!1),["prevent"]))}),i(e(fe),{flat:"",onClick:p[4]||(p[4]=X(_=>ee(),["prevent"]))},{default:f(()=>[e(g)?(n(),L(e(le),{key:0,color:"primary",size:"1rem"})):(n(),c(B,{key:1},[Ce(" Editar Projeto ")],64))]),_:1})]),_:1})],64))]),_:1}))}}),Je=Ie(He,[["__scopeId","data-v-97be169d"]]),D=w=>(be("data-v-f0a69895"),w=w(),xe(),w),Ke={class:"container-list"},Oe={class:"list-header"},Ge=D(()=>t("span",null,"Projetos do laboratório",-1)),Xe={key:0,class:"info"},Ye={key:1,class:"list"},Ze={class:"span-article"},et={class:"info"},tt=D(()=>t("h3",null,"Nenhum projeto encontrado!",-1)),ot=[tt],at=D(()=>t("div",{class:"divider"},null,-1)),lt={class:"project-container"},st={class:"profile-project"},it={class:"box-profile"},nt=["src"],rt={onClick:()=>{}},dt={class:"body-lab"},ut={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"1rem","justify-content":"space-between"}},ct={class:"button-bar"},pt={key:0},_t={key:1,style:{padding:"0.6rem"}},ft={class:"menu-lab-projeto"},vt=["src"],mt={class:"nameUser"},gt=D(()=>t("h2",null,"Membros",-1)),ht={key:0,class:"info-empty"},yt=D(()=>t("h3",null,"Não a nenhum membro no Projeto!",-1)),kt=[yt],jt={key:1},wt=D(()=>t("h2",null,"Descrição",-1)),Ct=D(()=>t("h2",null,"Data de criação",-1)),Pt=D(()=>t("h2",null,"Ultima atualização",-1)),bt=ye({__name:"ListProjetos",emits:["event"],setup(w){const T=$e(),N=De(),$=ke(),Y=Ue();let I=d(!1),l=d(),g=d(null),P=d(""),k=d(),z=d(),S=d(),M=d(),A=d(!1),b=d(!1),H=d(),h=d(!1);je(async()=>{await Q()});async function Q(){b.value=!0,k.value=N.getlaboratory,z.value=N.getUser,await F(),await p(),b.value=!1}async function Z(s){h.value=s,l.value=void 0,await Q()}function ee(){I.value=!0}function te(){h.value=!0}async function F(){var a;const s=await T.getAllProjetos((a=k.value)==null?void 0:a.id,$.getToken);s.listProject.length!==0?S.value=s.listProject:S.value=[]}async function p(){var s,a,u,C;if(((a=(s=k.value)==null?void 0:s.permissoes)==null?void 0:a.length)!==0){const v=(C=(u=k.value)==null?void 0:u.permissoes)==null?void 0:C.find(j=>{var r;return j.id_user===((r=z.value)==null?void 0:r.id)});if(v){const r=(await Y.getPermissionsLab()).find(y=>y.id===v.id_perm);P.value=r==null?void 0:r.title}else P.value=""}else P.value=""}async function _(s){I.value=s}async function V(){var a;const s=await T.deleteProjeto((a=l.value)==null?void 0:a.id,$.getToken);s?await Q():(A.value=!1,alert(s))}async function J(s){var u;const a=await T.addMember(((u=l.value)==null?void 0:u.id)??"",s,$.getToken);a?(await Q(),l.value=void 0):(A.value=!1,alert(a))}function oe(s){var C,v;l.value=s;const a=(C=k.value)==null?void 0:C.membros,u=(v=l.value)==null?void 0:v.membros;H.value=a==null?void 0:a.filter(j=>!(u!=null&&u.some(r=>r.id===j.id)))}return(s,a)=>{var u,C,v,j,r,y,K,R,O,ne,re,de,ue,ce,pe;return n(),c(B,null,[i(e(me),{modelValue:e(I),"onUpdate:modelValue":a[0]||(a[0]=o=>q(I)?I.value=o:I=o)},{default:f(()=>{var o;return[i(qe,{"id-lab":((o=e(k))==null?void 0:o.id)??"",onEvent:_},null,8,["id-lab"])]}),_:1},8,["modelValue"]),t("div",Ke,[t("div",Oe,[Ge,x(t("input",{type:"text",placeholder:"Buscar projeto","onUpdate:modelValue":a[1]||(a[1]=o=>q(M)?M.value=o:M=o)},null,512),[[se,e(M)]])]),e(b)?(n(),c("div",Xe,[i(e(le),{size:"20px",color:"primary"})])):(n(),c("div",Ye,[x(t("div",null,[(n(!0),c(B,null,ae(e(S),o=>(n(),L(e(Pe),{key:o.id,onClick:X(E=>oe(o),["prevent"]),dark:"",bordered:"",class:"card-project"},{default:f(()=>[i(e(G),null,{default:f(()=>[t("article",null,[t("h1",null,m(o.titulo),1),t("p",null,m(o.data_inicial),1)])]),_:2},1024),i(e(W),{dark:""}),i(e(G),null,{default:f(()=>[t("span",Ze,m(o.descricao),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))],512),[[U,((u=e(S))==null?void 0:u.length)!==0]]),x(t("div",et,ot,512),[[U,((C=e(S))==null?void 0:C.length)===0]])])),x(t("button",{onClick:a[2]||(a[2]=X(o=>ee(),["prevent"]))}," Criar Projeto ",512),[[U,e(P)==="Coordenador"]]),at,x(t("div",lt,[t("section",st,[t("div",it,[e(l)&&e(l).image?(n(),c("img",{key:0,class:"img-avatar",src:`${(v=e(l))==null?void 0:v.image}`,alt:"Imagem do Laboratorio"},null,8,nt)):ve("",!0),t("div",null,[t("h1",null,m((j=e(l))==null?void 0:j.titulo),1),t("p",null,m((r=e(l))==null?void 0:r.descricao),1),t("span",rt,[i(e(we),{name:"groups",size:"1.2rem"}),Ce(" "+m((K=(y=e(l))==null?void 0:y.membros)==null?void 0:K.length),1)])]),t("button",{onClick:a[3]||(a[3]=o=>te())}," Editar o projeto ")])]),t("section",dt,[i(e(me),{modelValue:e(h),"onUpdate:modelValue":a[4]||(a[4]=o=>q(h)?h.value=o:h=o)},{default:f(()=>[i(Je,{tipo:2,proj:e(l),onEvent:Z},null,8,["proj"])]),_:1},8,["modelValue"]),t("div",ut,[t("button",ct,[e(g)!==null?(n(),c("span",pt,m(((R=e(g))==null?void 0:R.primeiro_nome)+" "+((O=e(g))==null?void 0:O.segundo_nome)),1)):(n(),c("span",_t)),i(e(Me),{style:{width:"33%"}},{default:f(()=>[i(e(Ve),{style:{width:"100%","background-color":"#1F2026",border:"1px solid #333335"}},{default:f(()=>[(n(!0),c(B,null,ae(e(H),o=>(n(),L(e(Ee),{class:"q-item",key:o.id,clickable:"",onClick:E=>q(g)?g.value=o:g=o},{default:f(()=>[t("div",ft,[i(e(ge),{avatar:""},{default:f(()=>[o.image?(n(),c("img",{key:0,class:"img-menu",src:`${o==null?void 0:o.image}`,alt:"Imagem de usuario"},null,8,vt)):ve("",!0)]),_:2},1024),i(e(ge),null,{default:f(()=>[t("p",mt,m((o==null?void 0:o.primeiro_nome)+" "+(o==null?void 0:o.segundo_nome)),1)]),_:2},1024)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),t("button",{onClick:a[5]||(a[5]=o=>{var E;return J(((E=e(g))==null?void 0:E.id)??"")}),style:{padding:"0.6rem"}}," Adicionar membro ")]),x(i(e(W),{class:"divider"},null,512),[[U,e(P)==="Coordenador"||e(P)==="Supervisor"]]),t("div",null,[gt,((re=(ne=e(l))==null?void 0:ne.membros)==null?void 0:re.length)===0?(n(),c("article",ht,kt)):(n(),c("ul",jt,[(n(!0),c(B,null,ae((de=e(l))==null?void 0:de.membros,o=>{var E;return n(),L(Qe,{key:o.id??"",type:6,"id-projeto":(E=e(l))==null?void 0:E.id,"id-user":o.id??"",title:`${o.primeiro_nome} ${o.segundo_nome}`,"date-create":o.data_inicial??""},null,8,["id-projeto","id-user","title","date-create"])}),128))]))]),i(e(W),{class:"divider"}),t("div",null,[wt,t("p",null,m((ue=e(l))==null?void 0:ue.descricao),1)]),i(e(W),{class:"divider",dark:""}),t("div",null,[Ct,t("p",null,m((ce=e(l))==null?void 0:ce.data_inicial),1)]),i(e(W),{class:"divider",dark:""}),t("div",null,[Pt,t("p",null,m((pe=e(l))==null?void 0:pe.data_up),1)]),x(t("footer",null,[t("button",{onClick:a[6]||(a[6]=o=>V())}," Deletar projeto ")],512),[[U,e(P)==="Coordenador"]])])],512),[[U,e(l)]])])],64)}}}),Mt=Ie(bt,[["__scopeId","data-v-f0a69895"]]);export{Mt as default};
