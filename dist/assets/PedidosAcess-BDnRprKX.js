import{d as B,a1 as D,s as N,r as u,a2 as V,z as q,o as t,c as l,a as o,F as m,D as S,g as s,h as b,K as f,x as g,t as v,a3 as w,W as z,k as L,j as x,w as M,C as j,i as E,Q as F,a4 as T}from"./index-CS_LqtFy.js";import{p as U}from"./perm-CFx_5xxQ.js";const $={class:"box-pending"},I=o("span",null,"Pedidos de acesso",-1),K={class:"row q-gutter-md"},R={class:"text-h6"},W=["onSubmit"],G={class:"content-card"},H=["value"],J={type:"submit"},Z=B({__name:"PedidosAcess",setup(O){const h=D(),P=U(),Q=N();let _=u(),k=u(),c=u(!1),i=u();const y=V();q(async()=>{await C(),k.value=await P.getPermissions()});const C=async()=>{let n=await h.getPendingInSystem();n.forEach(r=>{r.perm=""}),_.value=n};async function A(n,r){var d;c.value=!0;const a={id:n.id,id_user:n.id_user,id_perm:i.value},p=Q.getToken;await h.releaseAcessUser(a,p)?(c.value=!1,(d=_.value)==null||d.splice(r,1),y.notify({message:"Acesso liberado!",color:"green"})):(c.value=!1,y.notify({message:"Não foi possível liberar o acesso, tente outra vez em alguns minutos!",color:"red"}))}return(n,r)=>(t(),l("div",$,[I,o("div",K,[(t(!0),l(m,null,S(s(_),(a,p)=>(t(),b(s(T),{dark:"",bordered:"",class:"my-card",key:a.id},{default:f(()=>[g(s(w),null,{default:f(()=>{var e,d;return[o("div",R,v(`${(e=a.usuario)==null?void 0:e.primeiro_nome} ${(d=a.usuario)==null?void 0:d.segundo_nome}`),1)]}),_:2},1024),g(s(z),{dark:""}),g(s(w),{class:"card-section"},{default:f(()=>[o("form",{onSubmit:L(e=>A(a,p),["prevent"])},[o("div",G,[x(v(a.data_create)+" ",1),M(o("select",{id:"permissions",name:"permissions",required:"","onUpdate:modelValue":r[0]||(r[0]=e=>E(i)?i.value=e:i=e)},[(t(!0),l(m,null,S(s(k),e=>(t(),l("option",{key:e.id,value:e.id},v(e.title),9,H))),128))],512),[[j,s(i)]])]),o("button",J,[s(c)?(t(),b(s(F),{key:0,size:"20px",color:"dark"})):(t(),l(m,{key:1},[x(" Liberar acesso ")],64))])],40,W)]),_:2},1024)]),_:2},1024))),128))])]))}});export{Z as default};
